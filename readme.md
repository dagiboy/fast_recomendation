# Модель быстрых рекомендаций
## Задача
Требуется написать сервис, который умеет в ограниченное время (80мс) выдавать рекомендации пользователю с истории пользователя. Т.е. в случайный момент времени пользователь делает некое действие с одним их объектов (например кликает по нему). Требуется в течении 80мс выдать рекомендации с учётом всей истории пользователя, включая последний клик.
## Решение
В качестве модели будет использована ItemToItem фильтрация с мерой Жаккара. Т.е. для каждой пары объектов i,j определим их похожесть:
$$ w(i,j) = \frac{\left| U_i \cap U_j \right|}{\left| U_i \cup U_j \right|} $$
Где $U_i$ - это множество пользователей, которые выбирали объект i.

Для каждого объекта определим $S_k^i$ - множество из k наиболее близких к объекту i оъектов.

Пользователю u, выбравшему объекты множеста $I_u$ будем рекомендовать $N$ наиболее подходящих ему объектов. Для этого:
- В качесте кандидатов на попадание в топ возьмём следующие объекты:
$$ C = \underset{i\in I_u}{\cup}S_k^i \setminus I_u$$
- Для кандидатов $c\in C$ определим похожесть на историю пользователя $I_u$, кaк
$$ w(c, I_u) = \sum_{i \in I_u} w(c, i)$$
- Вернём в качестве результата $N$ объектов из $C$ с максимальной величиной $w(c,I_u)$ 

## Реализация решения
В данном репозитории находится реалзицация описанного выше решения. Так как для рекомендации требуются исторические данные, они будут выкачиваться из репозитория kaggle. Чтобы это сделать требуется получить токен для обращения к их API. Заходим на страницу своегое пользователя kaggle.com/\<username\>/account (заменяемя username на свой). Далее нажимаем "Generate new API token". Скачанный файл закидываем в папку model текущего репозитория. Далее из корня репозитория запускаем команду 
```
sudo docker-compose up --build
```
Команда будет выполняться минут 15, так как надо скачать и обработать весь датасет. После успешной сборки проекта заходим через браузер на сайт http://localhost:8080/recommend?user=1000004&item=40

В качестве user можно выбрать любое число, модель сама создасть нового пользователя, если его не было в истории. В качестве item вводить число от 0 до 841661, так как в модели не заложено поведение для новых объектов.
